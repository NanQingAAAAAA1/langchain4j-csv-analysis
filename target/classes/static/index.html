<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>èŒä½æ•°æ®åˆ†æä»ªè¡¨æ¿</title>
    <script src="https://cdn.jsdelivr.net/npm/echarts@5.4.3/dist/echarts.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Microsoft YaHei', Arial, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
        }
        
        .header {
            text-align: center;
            color: white;
            margin-bottom: 30px;
        }
        
        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }
        
        .header p {
            font-size: 1.2em;
            opacity: 0.9;
        }
        
        /* ä¸‰æ å¸ƒå±€æ ·å¼ - å¤§å±æ•ˆæœ */
        .layout-container {
            display: grid;
            grid-template-columns: 1fr 1fr 1fr; /* ç­‰å®½ä¸‰åˆ— */
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .left-column, .center-column, .right-column {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }
        
        .chart-container {
            background: white;
            border-radius: 15px;
            padding: 20px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            transition: transform 0.3s ease;
        }
        
        .chart-container:hover {
            transform: translateY(-5px);
        }
        
        .chart-title {
            font-size: 1.3em;
            font-weight: bold;
            color: #333;
            margin-bottom: 15px;
            text-align: center;
            border-bottom: 2px solid #667eea;
            padding-bottom: 10px;
        }
        
        .chart {
            width: 100%;
            height: 400px; /* å›ºå®šé«˜åº¦ï¼Œä¸åŸå¸‚è–ªèµ„TOP10å’Œå­¦å†è–ªèµ„å…³ç³»ä¸€è‡´ */
        }
        
        /* æŒ‰é’®é¢æ¿æ ·å¼ */
        .button-panel {
            background: white;
            border-radius: 15px;
            padding: 20px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            display: flex;
            justify-content: space-between;
            gap: 15px;
            flex-shrink: 0; /* ä¸å‹ç¼©é«˜åº¦ */
        }
        
        .action-btn {
            flex: 1;
            padding: 15px 20px;
            border: none;
            border-radius: 10px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            font-size: 1em;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
        }
        
        .action-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(0,0,0,0.3);
            background: linear-gradient(135deg, #764ba2 0%, #667eea 100%);
        }
        
        .action-btn:active {
            transform: translateY(0);
        }
        
        .company-list {
            background: white;
            border-radius: 15px;
            padding: 20px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
        }
        
        .company-list h3 {
            font-size: 1.3em;
            font-weight: bold;
            color: #333;
            margin-bottom: 15px;
            text-align: center;
            border-bottom: 2px solid #667eea;
            padding-bottom: 10px;
        }
        
        .company-item {
            background: #f8f9fa;
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 10px;
            border-left: 4px solid #667eea;
            transition: all 0.3s ease;
        }
        
        .company-item:hover {
            background: #e9ecef;
            transform: translateX(5px);
        }
        
        .company-name {
            font-weight: bold;
            color: #333;
            font-size: 1.1em;
            margin-bottom: 5px;
        }
        
        .company-details {
            color: #666;
            font-size: 0.9em;
        }
        
        /* è‡ªåŠ¨æ»šåŠ¨æ ·å¼ */
        .company-scroll-container {
            height: 400px; /* å›ºå®šé«˜åº¦ï¼Œä¸å…¶ä»–å›¾è¡¨ä¸€è‡´ */
            overflow: hidden;
            position: relative;
            border-radius: 8px;
            background: #f8f9fa;
        }
        
        .company-scroll-content {
            animation: scrollUp 60s linear infinite;
            padding: 10px;
        }
        
        .company-scroll-content:hover {
            animation-play-state: paused;
        }
        
        @keyframes scrollUp {
            0% {
                transform: translateY(0);
            }
            100% {
                transform: translateY(-50%);
            }
        }
        
        .loading {
            text-align: center;
            color: white;
            font-size: 1.2em;
            padding: 50px;
        }
        
        .error {
            background: #f8d7da;
            color: #721c24;
            padding: 15px;
            border-radius: 8px;
            margin: 20px 0;
            text-align: center;
        }
        
        @media (max-width: 768px) {
            .layout-container {
                grid-template-columns: 1fr;
                gap: 15px;
            }
            
            .button-panel {
                flex-direction: column;
            }
            
            .header h1 {
                font-size: 2em;
            }
        }
    </style>
</head>
<body>
    <div class="container">
                <div class="header">
            <h1>ğŸ¤– AIGCæ±‚èŒåŠ©æ‰‹</h1>
        </div>
        
        <div id="loading" class="loading">
            <p>æ­£åœ¨åŠ è½½æ•°æ®...</p>
        </div>
        
        <div id="content" style="display: none;">
            <div class="layout-container">
                <!-- å·¦ä¾§æ  -->
                <div class="left-column">
                    <!-- åŸå¸‚è–ªèµ„TOP10 - æŸ±çŠ¶å›¾ -->
                    <div class="chart-container">
                        <div class="chart-title">ğŸ™ï¸ åŸå¸‚è–ªèµ„TOP10</div>
                        <div id="citySalaryChart" class="chart"></div>
                    </div>
                    
                    <!-- å­¦å†è–ªèµ„å…³ç³» - ç«ç‘°å›¾ -->
                    <div class="chart-container">
                        <div class="chart-title">ğŸ“ å­¦å†è–ªèµ„å…³ç³»</div>
                        <div id="educationSalaryChart" class="chart"></div>
                    </div>
                    
                    <!-- å…¬å¸ä¿¡æ¯æ»šåŠ¨åˆ—è¡¨ -->
                    <div class="company-list">
                        <h3>ğŸ¢ å…¬å¸ä¿¡æ¯åˆ—è¡¨</h3>
                        <div id="companyList" class="company-scroll-container"></div>
                    </div>
                </div>
                
                <!-- ä¸­é—´æ  -->
                <div class="center-column">
                    <!-- æŒ‰é’®åŒºåŸŸ -->
                    <div class="button-panel">
                        <button class="action-btn" id="btn1">æŒ‰é’®1</button>
                        <button class="action-btn" id="btn2">æŒ‰é’®2</button>
                        <button class="action-btn" id="btn3">æŒ‰é’®3</button>
                        <button class="action-btn" id="btn4">æŒ‰é’®4</button>
                    </div>
                    
                    <!-- ä¸­å›½åœ°å›¾ - å…¨å›½åŸå¸‚èŒä½æ•°é‡åˆ†å¸ƒ -->
                    <div class="chart-container">
                        <div class="chart-title">ğŸ—ºï¸ å…¨å›½åŸå¸‚èŒä½æ•°é‡åˆ†å¸ƒ</div>
                        <div id="chinaMap" class="chart"></div>
                    </div>
                </div>
                
                <!-- å³ä¾§æ  -->
                <div class="right-column">
                    <!-- åŸå¸‚èŒä½æ•°é‡TOP10 - æ•£ç‚¹å›¾ -->
                    <div class="chart-container">
                        <div class="chart-title">ğŸ“Š åŸå¸‚èŒä½æ•°é‡TOP10</div>
                        <div id="cityJobCountChart" class="chart"></div>
                    </div>
                    
                    <!-- å­¦å†è¦æ±‚åˆ†å¸ƒ - é¥¼å›¾ -->
                    <div class="chart-container">
                        <div class="chart-title">ğŸ“ å­¦å†è¦æ±‚åˆ†å¸ƒ</div>
                        <div id="educationDistributionChart" class="chart"></div>
                    </div>
                    
                    <!-- å­¦å†ç»éªŒå…³ç³» - çƒ­åŠ›å›¾ -->
                    <div class="chart-container">
                        <div class="chart-title">ğŸ”¥ å­¦å†ç»éªŒå…³ç³»çƒ­åŠ›å›¾</div>
                        <div id="educationExperienceChart" class="chart"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // å…¨å±€å˜é‡å­˜å‚¨æ•°æ®
        let analysisData = null;
        
        // åŠ è½½æ•°æ®
        async function loadData() {
            try {
                let apiData = null;
                
                // å°è¯•ä»APIè·å–åŸå¸‚å¹³å‡è–ªèµ„æ•°æ®
                try {
                    const apiResponse = await fetch('http://localhost:9090/loadChart/getCityAverageSalary');
                    if (apiResponse.ok) {
                        apiData = await apiResponse.json();
                        console.log('APIæ•°æ®è·å–æˆåŠŸ:', apiData);
                    } else {
                        console.warn('APIè¯·æ±‚å¤±è´¥ï¼Œä½¿ç”¨æœ¬åœ°æ•°æ®');
                    }
                } catch (apiError) {
                    console.warn('APIè°ƒç”¨å¤±è´¥ï¼Œä½¿ç”¨æœ¬åœ°æ•°æ®:', apiError);
                }
                
                // ä»æœ¬åœ°JSONæ–‡ä»¶è·å–æ•°æ®
                const localResponse = await fetch('/json/sql_analysis_result.json');
                if (!localResponse.ok) {
                    throw new Error('æ— æ³•åŠ è½½æœ¬åœ°æ•°æ®æ–‡ä»¶');
                }
                const localData = await localResponse.json();
                
                // åˆå¹¶æ•°æ®
                analysisData = {
                    ...localData,
                    'åŸå¸‚è–ªèµ„TOP10': apiData || localData['åŸå¸‚è–ªèµ„TOP10'] // å¦‚æœAPIå¤±è´¥ï¼Œä½¿ç”¨æœ¬åœ°æ•°æ®
                };
                
                console.log('æœ€ç»ˆåŠ è½½çš„æ•°æ®:', analysisData); // è°ƒè¯•ç”¨
                
                document.getElementById('loading').style.display = 'none';
                document.getElementById('content').style.display = 'block';
                renderAllCharts();
            } catch (error) {
                console.error('åŠ è½½æ•°æ®å¤±è´¥:', error);
                document.getElementById('loading').innerHTML = `
                    <div class="error">
                        <p>âŒ åŠ è½½æ•°æ®å¤±è´¥: ${error.message}</p>
                        <p>è¯·ç¡®ä¿analysis_result.jsonæ–‡ä»¶å­˜åœ¨äºresources/jsonç›®å½•ä¸‹</p>
                    </div>
                `;
            }
        }
        
                 // æ¸²æŸ“æ‰€æœ‰å›¾è¡¨
         function renderAllCharts() {
             renderCitySalaryChart();
             renderEducationSalaryChart();
             renderCompanyList();
             renderEducationExperienceChart();
             renderCityJobCountChart();
             renderEducationDistributionChart();
             renderChinaMap();
         }
        
                 // åŸå¸‚è–ªèµ„TOP10 - æŸ±çŠ¶å›¾
         function renderCitySalaryChart() {
             const chart = echarts.init(document.getElementById('citySalaryChart'));
             const data = analysisData['åŸå¸‚è–ªèµ„TOP10'] || [];
             
             const option = {
                 tooltip: {
                     trigger: 'axis',
                     formatter: function(params) {
                         const data = params[0];
                         return `${data.name}<br/>å¹³å‡è–ªèµ„: ${data.value}å…ƒ`;
                     }
                 },
                 grid: {
                     left: '3%',
                     right: '4%',
                     bottom: '3%',
                     containLabel: true
                 },
                 xAxis: {
                     type: 'category',
                     data: data.map(item => item.cityName),
                     axisLabel: {
                         rotate: 45,
                         fontSize: 12
                     }
                 },
                 yAxis: {
                     type: 'value',
                     name: 'å¹³å‡è–ªèµ„(å…ƒ)',
                     axisLabel: {
                         formatter: function(value) {
                             return (value / 1000).toFixed(0) + 'k';
                         }
                     }
                 },
                 series: [{
                     data: data.map(item => item.avgSalary),
                     type: 'bar',
                     itemStyle: {
                         color: new echarts.graphic.LinearGradient(0, 0, 0, 1, [
                             { offset: 0, color: '#83bff6' },
                             { offset: 0.5, color: '#188df0' },
                             { offset: 1, color: '#188df0' }
                         ])
                     },
                     emphasis: {
                         itemStyle: {
                             color: new echarts.graphic.LinearGradient(0, 0, 0, 1, [
                                 { offset: 0, color: '#2378f7' },
                                 { offset: 0.7, color: '#2378f7' },
                                 { offset: 1, color: '#83bff6' }
                             ])
                         }
                     }
                 }]
             };
             
             chart.setOption(option);
         }
        
        // å­¦å†è–ªèµ„å…³ç³» - ç«ç‘°å›¾
        function renderEducationSalaryChart() {
            const chart = echarts.init(document.getElementById('educationSalaryChart'));
            const data = analysisData['å­¦å†è–ªèµ„å…³ç³»'] || [];
            
            const option = {
                tooltip: {
                    trigger: 'item',
                    formatter: '{a} <br/>{b}: {c}å…ƒ ({d}%)'
                },
                legend: {
                    orient: 'vertical',
                    left: 'left'
                },
                series: [{
                    name: 'å¹³å‡è–ªèµ„',
                    type: 'pie',
                    radius: ['40%', '70%'],
                    center: ['50%', '50%'],
                    roseType: 'radius',
                    data: data.map(item => ({
                        name: item.educationLevel,
                        value: item.avgSalary
                    })),
                    itemStyle: {
                        borderRadius: 8
                    },
                    label: {
                        formatter: '{b}: {c}å…ƒ'
                    }
                }]
            };
            
            chart.setOption(option);
        }
        
        // å…¬å¸ä¿¡æ¯æ»šåŠ¨åˆ—è¡¨
        function renderCompanyList() {
            const companyList = document.getElementById('companyList');
            const data = analysisData['å…¬å¸ä¿¡æ¯'] || [];
            
            if (data.length === 0) {
                companyList.innerHTML = '<p style="text-align: center; color: #666;">æš‚æ— å…¬å¸ä¿¡æ¯</p>';
                return;
            }
            
            // é™åˆ¶æ˜¾ç¤ºå‰50å®¶å…¬å¸
            const displayData = data.slice(0, 50);
            
            // åˆ›å»ºæ»šåŠ¨å®¹å™¨
            companyList.innerHTML = `
                <div class="company-scroll-container">
                    <div class="company-scroll-content">
                        ${displayData.map(company => `
                            <div class="company-item">
                                <div class="company-name">${company.companyName || 'æœªçŸ¥å…¬å¸'}</div>
                                <div class="company-details">
                                    ç»éªŒè¦æ±‚: ${company.experienceLevel || 'ä¸é™'} | 
                                    å­¦å†è¦æ±‚: ${company.educationLevel || 'ä¸é™'} | 
                                    è–ªèµ„: ${company.salary || 'é¢è®®'}
                                </div>
                            </div>
                        `).join('')}
                        ${displayData.map(company => `
                            <div class="company-item">
                                <div class="company-name">${company.companyName || 'æœªçŸ¥å…¬å¸'}</div>
                                <div class="company-details">
                                    ç»éªŒè¦æ±‚: ${company.experienceLevel || 'ä¸é™'} | 
                                    å­¦å†è¦æ±‚: ${company.educationLevel || 'ä¸é™'} | 
                                    è–ªèµ„: ${company.salary || 'é¢è®®'}
                                </div>
                            </div>
                        `).join('')}
                    </div>
                </div>
            `;
            
            if (data.length > 50) {
                companyList.innerHTML += `
                    <div style="text-align: center; color: #666; margin-top: 20px;">
                        æ˜¾ç¤ºå‰50æ¡è®°å½•ï¼Œå…±${data.length}æ¡å…¬å¸ä¿¡æ¯
                    </div>
                `;
            }
        }
        
        // å­¦å†ç»éªŒå…³ç³» - çƒ­åŠ›å›¾
        function renderEducationExperienceChart() {
            const chart = echarts.init(document.getElementById('educationExperienceChart'));
            const data = analysisData['å­¦å†ç»éªŒå…³ç³»'] || [];
            
            // æå–å”¯ä¸€çš„å­¦å†å’Œç»éªŒå€¼
            const educationLevels = [...new Set(data.map(item => item.educationLevel))];
            const experienceLevels = [...new Set(data.map(item => item.experienceLevel))];
            
            // æ„å»ºçƒ­åŠ›å›¾æ•°æ®
            const heatmapData = [];
            educationLevels.forEach((edu, eduIndex) => {
                experienceLevels.forEach((exp, expIndex) => {
                    const item = data.find(d => d.educationLevel === edu && d.experienceLevel === exp);
                    if (item) {
                        heatmapData.push([expIndex, eduIndex, item.jobCount]);
                    }
                });
            });
            
            const option = {
                tooltip: {
                    position: 'top',
                    formatter: function(params) {
                        const edu = educationLevels[params.data[1]];
                        const exp = experienceLevels[params.data[0]];
                        return `${edu} + ${exp}<br/>èŒä½æ•°é‡: ${params.data[2]}`;
                    }
                },
                grid: {
                    height: '70%',
                    top: '10%'
                },
                xAxis: {
                    type: 'category',
                    data: experienceLevels,
                    splitArea: {
                        show: true
                    },
                    axisLabel: {
                        rotate: 45
                    }
                },
                yAxis: {
                    type: 'category',
                    data: educationLevels,
                    splitArea: {
                        show: true
                    }
                },
                visualMap: {
                    min: 0,
                    max: Math.max(...data.map(item => item.jobCount)),
                    calculable: true,
                    orient: 'horizontal',
                    left: 'center',
                    bottom: '15%',
                    inRange: {
                        color: ['#313695', '#4575b4', '#74add1', '#abd9e9', '#e0f3f8', '#ffffcc', '#fee090', '#fdae61', '#f46d43', '#d73027', '#a50026']
                    }
                },
                series: [{
                    name: 'èŒä½æ•°é‡',
                    type: 'heatmap',
                    data: heatmapData,
                    label: {
                        show: true,
                        formatter: function(params) {
                            return params.data[2];
                        }
                    },
                    emphasis: {
                        itemStyle: {
                            shadowBlur: 10,
                            shadowColor: 'rgba(0, 0, 0, 0.5)'
                        }
                    }
                }]
            };
            
            chart.setOption(option);
        }
        
                 // åŸå¸‚èŒä½æ•°é‡TOP10 - æ•£ç‚¹å›¾
         function renderCityJobCountChart() {
             const chart = echarts.init(document.getElementById('cityJobCountChart'));
             const data = analysisData['åŸå¸‚èŒä½æ•°é‡TOP10'] || [];
             
             // ç”Ÿæˆæ•£ç‚¹å›¾æ•°æ®ï¼šxè½´ä¸ºåŸå¸‚åç§°ï¼Œyè½´ä¸ºèŒä½æ•°é‡
             const scatterData = data.map((item, index) => [index, item.jobCount]);
             const cityNames = data.map(item => item.cityName);
             
             const option = {
                 tooltip: {
                     trigger: 'item',
                     formatter: function(params) {
                         const cityName = cityNames[params.data[0]];
                         return `${cityName}<br/>èŒä½æ•°é‡: ${params.data[1]}ä¸ª`;
                     }
                 },
                 grid: {
                     left: '15%',
                     right: '10%',
                     top: '15%',
                     bottom: '25%'
                 },
                 xAxis: {
                     type: 'category',
                     name: 'åŸå¸‚',
                     nameLocation: 'middle',
                     nameGap: 30,
                     data: cityNames,
                     axisLabel: {
                         rotate: 45,
                         fontSize: 12,
                         interval: 0
                     }
                 },
                 yAxis: {
                     type: 'value',
                     name: 'èŒä½æ•°é‡',
                     nameLocation: 'middle',
                     nameGap: 40
                 },
                 series: [{
                     name: 'åŸå¸‚èŒä½æ•°é‡',
                     type: 'scatter',
                     symbolSize: function(value) {
                         // æ ¹æ®èŒä½æ•°é‡åŠ¨æ€è°ƒæ•´ç‚¹çš„å¤§å°
                         return Math.max(8, Math.min(20, value[1] / 10));
                     },
                     data: scatterData,
                     itemStyle: {
                         color: new echarts.graphic.LinearGradient(0, 0, 0, 1, [
                             { offset: 0, color: '#ff6b6b' },
                             { offset: 0.5, color: '#4ecdc4' },
                             { offset: 1, color: '#45b7d1' }
                         ]),
                         opacity: 0.8
                     },
                     emphasis: {
                         itemStyle: {
                             shadowBlur: 10,
                             shadowColor: 'rgba(0, 0, 0, 0.3)',
                             opacity: 1
                         }
                     }
                 }]
             };
             
             chart.setOption(option);
         }
        
                 // å­¦å†è¦æ±‚åˆ†å¸ƒ - é¥¼å›¾
         function renderEducationDistributionChart() {
             const chart = echarts.init(document.getElementById('educationDistributionChart'));
             const data = analysisData['å­¦å†è¦æ±‚åˆ†å¸ƒ'] || [];
             
             const option = {
                 tooltip: {
                     trigger: 'item',
                     formatter: '{a} <br/>{b}: {c}ä¸ªèŒä½ ({d}%)'
                 },
                 legend: {
                     orient: 'vertical',
                     left: 'left',
                     type: 'scroll'
                 },
                 series: [{
                     name: 'å­¦å†è¦æ±‚',
                     type: 'pie',
                     radius: '55%',
                     center: ['50%', '50%'],
                     data: data.map(item => ({
                         name: item.educationLevel,
                         value: item.jobCount
                     })),
                     roseType: 'radius',
                     label: {
                         formatter: '{b}: {c}'
                     },
                     itemStyle: {
                         borderRadius: 8
                     },
                     emphasis: {
                         itemStyle: {
                             shadowBlur: 10,
                             shadowOffsetX: 0,
                             shadowColor: 'rgba(0, 0, 0, 0.5)'
                         }
                     }
                 }]
             };
             
             chart.setOption(option);
         }
        
                 // åŸå¸‚åˆ°çœä»½æ˜ å°„å‡½æ•° - é€‚é…é˜¿é‡Œäº‘DataVåœ°å›¾æ•°æ®ï¼ˆä½¿ç”¨å®Œæ•´çœä»½åç§°ï¼‰
         function getCityProvince(cityName) {
             // ç›´è¾–å¸‚æ˜ å°„ - ä½¿ç”¨å®Œæ•´åç§°
             const municipalities = {
                 'åŒ—äº¬': 'åŒ—äº¬å¸‚',
                 'ä¸Šæµ·': 'ä¸Šæµ·å¸‚', 
                 'å¤©æ´¥': 'å¤©æ´¥å¸‚',
                 'é‡åº†': 'é‡åº†å¸‚'
             };
             
             // ç‰¹åˆ«è¡Œæ”¿åŒºæ˜ å°„
             const specialRegions = {
                 'é¦™æ¸¯': 'é¦™æ¸¯ç‰¹åˆ«è¡Œæ”¿åŒº',
                 'æ¾³é—¨': 'æ¾³é—¨ç‰¹åˆ«è¡Œæ”¿åŒº'
             };
             
             // å…¶ä»–åŸå¸‚åˆ°çœä»½æ˜ å°„ - ä½¿ç”¨é˜¿é‡Œäº‘DataVçš„å®Œæ•´çœä»½åç§°
             const cityToProvince = {
                 'å¹¿å·': 'å¹¿ä¸œçœ', 'æ·±åœ³': 'å¹¿ä¸œçœ', 'ç æµ·': 'å¹¿ä¸œçœ', 'æ±•å¤´': 'å¹¿ä¸œçœ', 'ä½›å±±': 'å¹¿ä¸œçœ', 'éŸ¶å…³': 'å¹¿ä¸œçœ', 'æ¹›æ±Ÿ': 'å¹¿ä¸œçœ', 'è‚‡åº†': 'å¹¿ä¸œçœ', 'æ±Ÿé—¨': 'å¹¿ä¸œçœ', 'èŒ‚å': 'å¹¿ä¸œçœ', 'æƒ å·': 'å¹¿ä¸œçœ', 'æ¢…å·': 'å¹¿ä¸œçœ', 'æ±•å°¾': 'å¹¿ä¸œçœ', 'æ²³æº': 'å¹¿ä¸œçœ', 'é˜³æ±Ÿ': 'å¹¿ä¸œçœ', 'æ¸…è¿œ': 'å¹¿ä¸œçœ', 'ä¸œè': 'å¹¿ä¸œçœ', 'ä¸­å±±': 'å¹¿ä¸œçœ', 'æ½®å·': 'å¹¿ä¸œçœ', 'æ­é˜³': 'å¹¿ä¸œçœ', 'äº‘æµ®': 'å¹¿ä¸œçœ',
                 'æ­å·': 'æµ™æ±Ÿçœ', 'å®æ³¢': 'æµ™æ±Ÿçœ', 'æ¸©å·': 'æµ™æ±Ÿçœ', 'å˜‰å…´': 'æµ™æ±Ÿçœ', 'æ¹–å·': 'æµ™æ±Ÿçœ', 'ç»å…´': 'æµ™æ±Ÿçœ', 'é‡‘å': 'æµ™æ±Ÿçœ', 'è¡¢å·': 'æµ™æ±Ÿçœ', 'èˆŸå±±': 'æµ™æ±Ÿçœ', 'å°å·': 'æµ™æ±Ÿçœ', 'ä¸½æ°´': 'æµ™æ±Ÿçœ',
                 'å—äº¬': 'æ±Ÿè‹çœ', 'æ— é”¡': 'æ±Ÿè‹çœ', 'å¾å·': 'æ±Ÿè‹çœ', 'å¸¸å·': 'æ±Ÿè‹çœ', 'è‹å·': 'æ±Ÿè‹çœ', 'å—é€š': 'æ±Ÿè‹çœ', 'è¿äº‘æ¸¯': 'æ±Ÿè‹çœ', 'æ·®å®‰': 'æ±Ÿè‹çœ', 'ç›åŸ': 'æ±Ÿè‹çœ', 'æ‰¬å·': 'æ±Ÿè‹çœ', 'é•‡æ±Ÿ': 'æ±Ÿè‹çœ', 'æ³°å·': 'æ±Ÿè‹çœ', 'å®¿è¿': 'æ±Ÿè‹çœ',
                 'æµå—': 'å±±ä¸œçœ', 'é’å²›': 'å±±ä¸œçœ', 'æ·„åš': 'å±±ä¸œçœ', 'æ£åº„': 'å±±ä¸œçœ', 'ä¸œè¥': 'å±±ä¸œçœ', 'çƒŸå°': 'å±±ä¸œçœ', 'æ½åŠ': 'å±±ä¸œçœ', 'æµå®': 'å±±ä¸œçœ', 'æ³°å®‰': 'å±±ä¸œçœ', 'å¨æµ·': 'å±±ä¸œçœ', 'æ—¥ç…§': 'å±±ä¸œçœ', 'è±èŠœ': 'å±±ä¸œçœ', 'ä¸´æ²‚': 'å±±ä¸œçœ', 'å¾·å·': 'å±±ä¸œçœ', 'èŠåŸ': 'å±±ä¸œçœ', 'æ»¨å·': 'å±±ä¸œçœ', 'èæ³½': 'å±±ä¸œçœ',
                 'éƒ‘å·': 'æ²³å—çœ', 'å¼€å°': 'æ²³å—çœ', 'æ´›é˜³': 'æ²³å—çœ', 'å¹³é¡¶å±±': 'æ²³å—çœ', 'å®‰é˜³': 'æ²³å—çœ', 'é¹¤å£': 'æ²³å—çœ', 'æ–°ä¹¡': 'æ²³å—çœ', 'ç„¦ä½œ': 'æ²³å—çœ', 'æ¿®é˜³': 'æ²³å—çœ', 'è®¸æ˜Œ': 'æ²³å—çœ', 'æ¼¯æ²³': 'æ²³å—çœ', 'ä¸‰é—¨å³¡': 'æ²³å—çœ', 'å—é˜³': 'æ²³å—çœ', 'å•†ä¸˜': 'æ²³å—çœ', 'ä¿¡é˜³': 'æ²³å—çœ', 'å‘¨å£': 'æ²³å—çœ', 'é©»é©¬åº—': 'æ²³å—çœ',
                 'æ­¦æ±‰': 'æ¹–åŒ—çœ', 'é»„çŸ³': 'æ¹–åŒ—çœ', 'åå °': 'æ¹–åŒ—çœ', 'å®œæ˜Œ': 'æ¹–åŒ—çœ', 'è¥„é˜³': 'æ¹–åŒ—çœ', 'é„‚å·': 'æ¹–åŒ—çœ', 'è†é—¨': 'æ¹–åŒ—çœ', 'å­æ„Ÿ': 'æ¹–åŒ—çœ', 'è†å·': 'æ¹–åŒ—çœ', 'é»„å†ˆ': 'æ¹–åŒ—çœ', 'å’¸å®': 'æ¹–åŒ—çœ', 'éšå·': 'æ¹–åŒ—çœ',
                 'é•¿æ²™': 'æ¹–å—çœ', 'æ ªæ´²': 'æ¹–å—çœ', 'æ¹˜æ½­': 'æ¹–å—çœ', 'è¡¡é˜³': 'æ¹–å—çœ', 'é‚µé˜³': 'æ¹–å—çœ', 'å²³é˜³': 'æ¹–å—çœ', 'å¸¸å¾·': 'æ¹–å—çœ', 'å¼ å®¶ç•Œ': 'æ¹–å—çœ', 'ç›Šé˜³': 'æ¹–å—çœ', 'éƒ´å·': 'æ¹–å—çœ', 'æ°¸å·': 'æ¹–å—çœ', 'æ€€åŒ–': 'æ¹–å—çœ', 'å¨„åº•': 'æ¹–å—çœ',
                 'æˆéƒ½': 'å››å·çœ', 'è‡ªè´¡': 'å››å·çœ', 'æ”€æèŠ±': 'å››å·çœ', 'æ³¸å·': 'å››å·çœ', 'å¾·é˜³': 'å››å·çœ', 'ç»µé˜³': 'å››å·çœ', 'å¹¿å…ƒ': 'å››å·çœ', 'é‚å®': 'å››å·çœ', 'å†…æ±Ÿ': 'å››å·çœ', 'ä¹å±±': 'å››å·çœ', 'å—å……': 'å››å·çœ', 'çœ‰å±±': 'å››å·çœ', 'å®œå®¾': 'å››å·çœ', 'å¹¿å®‰': 'å››å·çœ', 'è¾¾å·': 'å››å·çœ', 'é›…å®‰': 'å››å·çœ', 'å·´ä¸­': 'å››å·çœ', 'èµ„é˜³': 'å››å·çœ',
                 'è¥¿å®‰': 'é™•è¥¿çœ', 'é“œå·': 'é™•è¥¿çœ', 'å®é¸¡': 'é™•è¥¿çœ', 'å’¸é˜³': 'é™•è¥¿çœ', 'æ¸­å—': 'é™•è¥¿çœ', 'å»¶å®‰': 'é™•è¥¿çœ', 'æ±‰ä¸­': 'é™•è¥¿çœ', 'æ¦†æ—': 'é™•è¥¿çœ', 'å®‰åº·': 'é™•è¥¿çœ', 'å•†æ´›': 'é™•è¥¿çœ',
                 'åˆè‚¥': 'å®‰å¾½çœ', 'èŠœæ¹–': 'å®‰å¾½çœ', 'èšŒåŸ ': 'å®‰å¾½çœ', 'æ·®å—': 'å®‰å¾½çœ', 'é©¬éå±±': 'å®‰å¾½çœ', 'æ·®åŒ—': 'å®‰å¾½çœ', 'é“œé™µ': 'å®‰å¾½çœ', 'å®‰åº†': 'å®‰å¾½çœ', 'é»„å±±': 'å®‰å¾½çœ', 'æ»å·': 'å®‰å¾½çœ', 'é˜œé˜³': 'å®‰å¾½çœ', 'å®¿å·': 'å®‰å¾½çœ', 'å…­å®‰': 'å®‰å¾½çœ', 'äº³å·': 'å®‰å¾½çœ', 'æ± å·': 'å®‰å¾½çœ', 'å®£åŸ': 'å®‰å¾½çœ',
                 'ç¦å·': 'ç¦å»ºçœ', 'å¦é—¨': 'ç¦å»ºçœ', 'è†ç”°': 'ç¦å»ºçœ', 'ä¸‰æ˜': 'ç¦å»ºçœ', 'æ³‰å·': 'ç¦å»ºçœ', 'æ¼³å·': 'ç¦å»ºçœ', 'å—å¹³': 'ç¦å»ºçœ', 'é¾™å²©': 'ç¦å»ºçœ', 'å®å¾·': 'ç¦å»ºçœ',
                 'å—æ˜Œ': 'æ±Ÿè¥¿çœ', 'æ™¯å¾·é•‡': 'æ±Ÿè¥¿çœ', 'èä¹¡': 'æ±Ÿè¥¿çœ', 'ä¹æ±Ÿ': 'æ±Ÿè¥¿çœ', 'æ–°ä½™': 'æ±Ÿè¥¿çœ', 'é¹°æ½­': 'æ±Ÿè¥¿çœ', 'èµ£å·': 'æ±Ÿè¥¿çœ', 'å‰å®‰': 'æ±Ÿè¥¿çœ', 'å®œæ˜¥': 'æ±Ÿè¥¿çœ', 'æŠšå·': 'æ±Ÿè¥¿çœ', 'ä¸Šé¥¶': 'æ±Ÿè¥¿çœ',
                 'çŸ³å®¶åº„': 'æ²³åŒ—çœ', 'å”å±±': 'æ²³åŒ—çœ', 'ç§¦çš‡å²›': 'æ²³åŒ—çœ', 'é‚¯éƒ¸': 'æ²³åŒ—çœ', 'é‚¢å°': 'æ²³åŒ—çœ', 'ä¿å®š': 'æ²³åŒ—çœ', 'å¼ å®¶å£': 'æ²³åŒ—çœ', 'æ‰¿å¾·': 'æ²³åŒ—çœ', 'æ²§å·': 'æ²³åŒ—çœ', 'å»ŠåŠ': 'æ²³åŒ—çœ', 'è¡¡æ°´': 'æ²³åŒ—çœ',
                 'å¤ªåŸ': 'å±±è¥¿çœ', 'å¤§åŒ': 'å±±è¥¿çœ', 'é˜³æ³‰': 'å±±è¥¿çœ', 'é•¿æ²»': 'å±±è¥¿çœ', 'æ™‹åŸ': 'å±±è¥¿çœ', 'æœ”å·': 'å±±è¥¿çœ', 'æ™‹ä¸­': 'å±±è¥¿çœ', 'è¿åŸ': 'å±±è¥¿çœ', 'å¿»å·': 'å±±è¥¿çœ', 'ä¸´æ±¾': 'å±±è¥¿çœ', 'å•æ¢': 'å±±è¥¿çœ',
                 'å‘¼å’Œæµ©ç‰¹': 'å†…è’™å¤è‡ªæ²»åŒº', 'åŒ…å¤´': 'å†…è’™å¤è‡ªæ²»åŒº', 'ä¹Œæµ·': 'å†…è’™å¤è‡ªæ²»åŒº', 'èµ¤å³°': 'å†…è’™å¤è‡ªæ²»åŒº', 'é€šè¾½': 'å†…è’™å¤è‡ªæ²»åŒº', 'é„‚å°”å¤šæ–¯': 'å†…è’™å¤è‡ªæ²»åŒº', 'å‘¼ä¼¦è´å°”': 'å†…è’™å¤è‡ªæ²»åŒº', 'å·´å½¦æ·–å°”': 'å†…è’™å¤è‡ªæ²»åŒº', 'ä¹Œå…°å¯Ÿå¸ƒ': 'å†…è’™å¤è‡ªæ²»åŒº',
                 'æ²ˆé˜³': 'è¾½å®çœ', 'å¤§è¿': 'è¾½å®çœ', 'éå±±': 'è¾½å®çœ', 'æŠšé¡º': 'è¾½å®çœ', 'æœ¬æºª': 'è¾½å®çœ', 'ä¸¹ä¸œ': 'è¾½å®çœ', 'é”¦å·': 'è¾½å®çœ', 'è¥å£': 'è¾½å®çœ', 'é˜œæ–°': 'è¾½å®çœ', 'è¾½é˜³': 'è¾½å®çœ', 'ç›˜é”¦': 'è¾½å®çœ', 'é“å²­': 'è¾½å®çœ', 'æœé˜³': 'è¾½å®çœ', 'è‘«èŠ¦å²›': 'è¾½å®çœ',
                 'é•¿æ˜¥': 'å‰æ—çœ', 'å‰æ—': 'å‰æ—çœ', 'å››å¹³': 'å‰æ—çœ', 'è¾½æº': 'å‰æ—çœ', 'é€šåŒ–': 'å‰æ—çœ', 'ç™½å±±': 'å‰æ—çœ', 'æ¾åŸ': 'å‰æ—çœ', 'ç™½åŸ': 'å‰æ—çœ',
                 'å“ˆå°”æ»¨': 'é»‘é¾™æ±Ÿçœ', 'é½é½å“ˆå°”': 'é»‘é¾™æ±Ÿçœ', 'é¸¡è¥¿': 'é»‘é¾™æ±Ÿçœ', 'é¹¤å²—': 'é»‘é¾™æ±Ÿçœ', 'åŒé¸­å±±': 'é»‘é¾™æ±Ÿçœ', 'å¤§åº†': 'é»‘é¾™æ±Ÿçœ', 'ä¼Šæ˜¥': 'é»‘é¾™æ±Ÿçœ', 'ä½³æœ¨æ–¯': 'é»‘é¾™æ±Ÿçœ', 'ä¸ƒå°æ²³': 'é»‘é¾™æ±Ÿçœ', 'ç‰¡ä¸¹æ±Ÿ': 'é»‘é¾™æ±Ÿçœ', 'é»‘æ²³': 'é»‘é¾™æ±Ÿçœ', 'ç»¥åŒ–': 'é»‘é¾™æ±Ÿçœ',
                 'æ˜†æ˜': 'äº‘å—çœ', 'æ›²é–': 'äº‘å—çœ', 'ç‰æºª': 'äº‘å—çœ', 'ä¿å±±': 'äº‘å—çœ', 'æ˜­é€š': 'äº‘å—çœ', 'ä¸½æ±Ÿ': 'äº‘å—çœ', 'æ™®æ´±': 'äº‘å—çœ', 'ä¸´æ²§': 'äº‘å—çœ',
                 'è´µé˜³': 'è´µå·çœ', 'å…­ç›˜æ°´': 'è´µå·çœ', 'éµä¹‰': 'è´µå·çœ', 'å®‰é¡º': 'è´µå·çœ', 'æ¯•èŠ‚': 'è´µå·çœ', 'é“œä»': 'è´µå·çœ',
                 'å—å®': 'å¹¿è¥¿å£®æ—è‡ªæ²»åŒº', 'æŸ³å·': 'å¹¿è¥¿å£®æ—è‡ªæ²»åŒº', 'æ¡‚æ—': 'å¹¿è¥¿å£®æ—è‡ªæ²»åŒº', 'æ¢§å·': 'å¹¿è¥¿å£®æ—è‡ªæ²»åŒº', 'åŒ—æµ·': 'å¹¿è¥¿å£®æ—è‡ªæ²»åŒº', 'é˜²åŸæ¸¯': 'å¹¿è¥¿å£®æ—è‡ªæ²»åŒº', 'é’¦å·': 'å¹¿è¥¿å£®æ—è‡ªæ²»åŒº', 'è´µæ¸¯': 'å¹¿è¥¿å£®æ—è‡ªæ²»åŒº', 'ç‰æ—': 'å¹¿è¥¿å£®æ—è‡ªæ²»åŒº', 'ç™¾è‰²': 'å¹¿è¥¿å£®æ—è‡ªæ²»åŒº', 'è´ºå·': 'å¹¿è¥¿å£®æ—è‡ªæ²»åŒº', 'æ²³æ± ': 'å¹¿è¥¿å£®æ—è‡ªæ²»åŒº', 'æ¥å®¾': 'å¹¿è¥¿å£®æ—è‡ªæ²»åŒº', 'å´‡å·¦': 'å¹¿è¥¿å£®æ—è‡ªæ²»åŒº',
                 'æµ·å£': 'æµ·å—çœ', 'ä¸‰äºš': 'æµ·å—çœ', 'ä¸‰æ²™': 'æµ·å—çœ', 'å„‹å·': 'æµ·å—çœ',
                 'å…°å·': 'ç”˜è‚ƒçœ', 'å˜‰å³ªå…³': 'ç”˜è‚ƒçœ', 'é‡‘æ˜Œ': 'ç”˜è‚ƒçœ', 'ç™½é“¶': 'ç”˜è‚ƒçœ', 'å¤©æ°´': 'ç”˜è‚ƒçœ', 'æ­¦å¨': 'ç”˜è‚ƒçœ', 'å¼ æ–': 'ç”˜è‚ƒçœ', 'å¹³å‡‰': 'ç”˜è‚ƒçœ', 'é…’æ³‰': 'ç”˜è‚ƒçœ', 'åº†é˜³': 'ç”˜è‚ƒçœ', 'å®šè¥¿': 'ç”˜è‚ƒçœ', 'é™‡å—': 'ç”˜è‚ƒçœ',
                 'è¥¿å®': 'é’æµ·çœ', 'æµ·ä¸œ': 'é’æµ·çœ',
                 'é“¶å·': 'å®å¤å›æ—è‡ªæ²»åŒº', 'çŸ³å˜´å±±': 'å®å¤å›æ—è‡ªæ²»åŒº', 'å´å¿ ': 'å®å¤å›æ—è‡ªæ²»åŒº', 'å›ºåŸ': 'å®å¤å›æ—è‡ªæ²»åŒº', 'ä¸­å«': 'å®å¤å›æ—è‡ªæ²»åŒº',
                 'ä¹Œé²æœ¨é½': 'æ–°ç–†ç»´å¾å°”è‡ªæ²»åŒº', 'å…‹æ‹‰ç›ä¾': 'æ–°ç–†ç»´å¾å°”è‡ªæ²»åŒº',
                 'æ‹‰è¨': 'è¥¿è—è‡ªæ²»åŒº', 'æ—¥å–€åˆ™': 'è¥¿è—è‡ªæ²»åŒº', 'æ˜Œéƒ½': 'è¥¿è—è‡ªæ²»åŒº', 'æ—èŠ': 'è¥¿è—è‡ªæ²»åŒº', 'å±±å—': 'è¥¿è—è‡ªæ²»åŒº', 'é‚£æ›²': 'è¥¿è—è‡ªæ²»åŒº',
                 'å°åŒ—': 'å°æ¹¾çœ', 'é«˜é›„': 'å°æ¹¾çœ', 'åŸºéš†': 'å°æ¹¾çœ', 'å°ä¸­': 'å°æ¹¾çœ', 'å°å—': 'å°æ¹¾çœ', 'æ–°ç«¹': 'å°æ¹¾çœ', 'å˜‰ä¹‰': 'å°æ¹¾çœ'
             };
             
             // æ£€æŸ¥ç›´è¾–å¸‚
             if (municipalities[cityName]) {
                 return municipalities[cityName];
             }
             
             // æ£€æŸ¥ç‰¹åˆ«è¡Œæ”¿åŒº
             if (specialRegions[cityName]) {
                 return specialRegions[cityName];
             }
             
             // æ£€æŸ¥å…¶ä»–åŸå¸‚
             if (cityToProvince[cityName]) {
                 return cityToProvince[cityName];
             }
             
             // å¦‚æœæ²¡æ‰¾åˆ°æ˜ å°„ï¼Œè¿”å›åŸåŸå¸‚å
             return cityName;
         }
         
         // è®¡ç®—çœä»½èŒä½æ•°é‡
         function calculateProvinceSalary(cityJobData) {
             console.log('å¼€å§‹è®¡ç®—çœä»½æ•°æ®ï¼Œè¾“å…¥æ•°æ®:', cityJobData);
             
             const provinceData = {};
             
             cityJobData.forEach(item => {
                 const province = getCityProvince(item.cityName);
                 console.log(`åŸå¸‚ ${item.cityName} æ˜ å°„åˆ°çœä»½: ${province}`);
                 
                 if (!provinceData[province]) {
                     provinceData[province] = {
                         totalJobs: 0,
                         cities: []
                     };
                 }
                 
                 provinceData[province].totalJobs += item.jobCount;
                 provinceData[province].cities.push(item.cityName);
             });
             
             const result = Object.keys(provinceData).map(province => ({
                 name: province,
                 value: provinceData[province].totalJobs
             }));
             
             console.log('çœä»½æ•°æ®è®¡ç®—ç»“æœ:', result);
             return result;
         }
         
         // ä¸­å›½åœ°å›¾æ¸²æŸ“å‡½æ•°
         async function renderChinaMap() {
             try {
                 console.log('å¼€å§‹æ¸²æŸ“ä¸­å›½åœ°å›¾...');
                 
                 let chinaMapData = null;
                 
                 // å°è¯•åŠ è½½ä¸­å›½åœ°å›¾æ•°æ®
                 try {
                     const mapResponse = await fetch('https://geo.datav.aliyun.com/areas_v3/bound/100000_full.json');
                     if (mapResponse.ok) {
                         chinaMapData = await mapResponse.json();
                         console.log('åœ°å›¾æ•°æ®åŠ è½½æˆåŠŸï¼Œçœä»½æ•°é‡:', chinaMapData.features.length);
                         

                     } else {
                         throw new Error('åœ°å›¾æ•°æ®è¯·æ±‚å¤±è´¥');
                     }
                 } catch (mapError) {
                     console.warn('æ— æ³•ä»é˜¿é‡Œäº‘åŠ è½½åœ°å›¾æ•°æ®ï¼Œå°è¯•ä½¿ç”¨å¤‡ç”¨æ–¹æ¡ˆ:', mapError);
                     
                     // å¤‡ç”¨æ–¹æ¡ˆï¼šä½¿ç”¨ç®€åŒ–çš„ä¸­å›½åœ°å›¾æ•°æ®
                     chinaMapData = {
                         type: "FeatureCollection",
                         features: [
                             { type: "Feature", properties: { name: "åŒ—äº¬" }, geometry: { type: "Polygon", coordinates: [[[116.0, 40.0], [117.0, 40.0], [117.0, 39.0], [116.0, 39.0], [116.0, 40.0]]] } },
                             { type: "Feature", properties: { name: "ä¸Šæµ·" }, geometry: { type: "Polygon", coordinates: [[[121.0, 31.0], [122.0, 31.0], [122.0, 30.0], [121.0, 30.0], [121.0, 31.0]]] } },
                             { type: "Feature", properties: { name: "å¹¿ä¸œ" }, geometry: { type: "Polygon", coordinates: [[[113.0, 23.0], [114.0, 23.0], [114.0, 22.0], [113.0, 22.0], [113.0, 23.0]]] } },
                             { type: "Feature", properties: { name: "æ±Ÿè‹" }, geometry: { type: "Polygon", coordinates: [[[118.0, 32.0], [119.0, 32.0], [119.0, 31.0], [118.0, 31.0], [118.0, 32.0]]] } },
                             { type: "Feature", properties: { name: "æµ™æ±Ÿ" }, geometry: { type: "Polygon", coordinates: [[[120.0, 30.0], [121.0, 30.0], [121.0, 29.0], [120.0, 29.0], [120.0, 30.0]]] } },
                             { type: "Feature", properties: { name: "å››å·" }, geometry: { type: "Polygon", coordinates: [[[103.0, 30.0], [104.0, 30.0], [104.0, 29.0], [103.0, 29.0], [103.0, 30.0]]] } },
                             { type: "Feature", properties: { name: "æ¹–åŒ—" }, geometry: { type: "Polygon", coordinates: [[[114.0, 30.0], [115.0, 30.0], [115.0, 29.0], [114.0, 29.0], [114.0, 30.0]]] } },
                             { type: "Feature", properties: { name: "æ¹–å—" }, geometry: { type: "Polygon", coordinates: [[[112.0, 28.0], [113.0, 28.0], [113.0, 27.0], [112.0, 27.0], [112.0, 28.0]]] } },
                             { type: "Feature", properties: { name: "å¹¿è¥¿" }, geometry: { type: "Polygon", coordinates: [[[108.0, 23.0], [109.0, 23.0], [109.0, 22.0], [108.0, 22.0], [108.0, 23.0]]] } },
                             { type: "Feature", properties: { name: "è¾½å®" }, geometry: { type: "Polygon", coordinates: [[[122.0, 41.0], [123.0, 41.0], [123.0, 40.0], [122.0, 40.0], [122.0, 41.0]]] } }
                         ]
                     };
                     console.log('ä½¿ç”¨å¤‡ç”¨åœ°å›¾æ•°æ®');
                 }
                 
                 const chart = echarts.init(document.getElementById('chinaMap'));
                 const cityJobData = analysisData['åŸå¸‚èŒä½æ•°é‡'] || [];
                 
                 console.log('åŸå¸‚èŒä½æ•°æ®:', cityJobData);
                 
                 // æ³¨å†Œåœ°å›¾
                 echarts.registerMap('china', chinaMapData);
                 
                 // è®¡ç®—çœä»½æ•°æ®
                 const provinceData = calculateProvinceSalary(cityJobData);
                 
                 console.log('è®¡ç®—åçš„çœä»½æ•°æ®:', provinceData);
                 
                 // æ£€æŸ¥æ˜¯å¦æœ‰æ•°æ®
                 if (provinceData.length === 0) {
                     console.warn('æ²¡æœ‰çœä»½æ•°æ®ï¼Œæ˜¾ç¤ºç©ºåœ°å›¾');
                     const option = {
                         tooltip: {
                             trigger: 'item',
                             formatter: function(params) {
                                 return `${params.name}<br/>æš‚æ— æ•°æ®`;
                             }
                         },
                         series: [{
                             name: 'èŒä½æ•°é‡',
                             type: 'map',
                             map: 'china',
                             roam: true,
                             emphasis: {
                                 label: {
                                     show: true,
                                     fontSize: 12
                                 },
                                 itemStyle: {
                                     areaColor: '#ff6b6b',
                                     shadowBlur: 10,
                                     shadowColor: 'rgba(0, 0, 0, 0.3)'
                                 }
                             },
                             select: {
                                 disabled: true
                             },
                             data: []
                         }]
                     };
                     chart.setOption(option);
                     return;
                 }
                 
                 // è®¡ç®—é¢œè‰²èŒƒå›´
                 const maxValue = Math.max(...provinceData.map(item => item.value));
                 const minValue = Math.min(...provinceData.map(item => item.value));
                 
                 console.log('æ•°æ®èŒƒå›´:', { minValue, maxValue });
                 
                 const option = {
                     tooltip: {
                         trigger: 'item',
                         formatter: function(params) {
                             if (params.data) {
                                 return `${params.name}<br/>èŒä½æ•°é‡: ${params.value.toLocaleString()}ä¸ª`;
                             }
                             return `${params.name}<br/>æš‚æ— æ•°æ®`;
                         }
                     },
                     visualMap: {
                         type: 'continuous',
                         min: minValue,
                         max: maxValue,
                         left: 'left',
                         top: 'bottom',
                         text: ['é«˜', 'ä½'],
                         calculable: true,
                         inRange: {
                             color: ['#e0f3f8', '#abd9e9', '#74add1', '#4575b4', '#313695']
                         },
                         textStyle: {
                             color: '#333'
                         }
                     },
                     series: [{
                         name: 'èŒä½æ•°é‡',
                         type: 'map',
                         map: 'china',
                         roam: true,
                         emphasis: {
                             label: {
                                 show: true,
                                 fontSize: 12
                             },
                             itemStyle: {
                                 areaColor: '#ff6b6b',
                                 shadowBlur: 10,
                                 shadowColor: 'rgba(0, 0, 0, 0.3)'
                             }
                         },
                         select: {
                             disabled: true
                         },
                         data: provinceData
                     }]
                 };
                 
                 chart.setOption(option);
                 console.log('ä¸­å›½åœ°å›¾æ¸²æŸ“å®Œæˆ');
                 
             } catch (error) {
                 console.error('åŠ è½½ä¸­å›½åœ°å›¾å¤±è´¥:', error);
                 // æ˜¾ç¤ºé”™è¯¯ä¿¡æ¯
                 const chart = echarts.init(document.getElementById('chinaMap'));
                 chart.setOption({
                     title: {
                         text: 'åœ°å›¾åŠ è½½å¤±è´¥',
                         left: 'center',
                         top: 'center',
                         textStyle: {
                             color: '#ff6b6b',
                             fontSize: 16
                         }
                     }
                 });
             }
         }
         
         // é¡µé¢åŠ è½½å®Œæˆåæ‰§è¡Œ
         document.addEventListener('DOMContentLoaded', function() {
             loadData();
             
             // å“åº”å¼å¤„ç†
             window.addEventListener('resize', function() {
                 const charts = document.querySelectorAll('.chart');
                 charts.forEach(chart => {
                     const instance = echarts.getInstanceByDom(chart);
                     if (instance) {
                         instance.resize();
                     }
                 });
             });
         });
    </script>
</body>
</html> 